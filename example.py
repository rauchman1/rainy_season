import numpy as np
import pandas as pd
from matplotlib import pyplot as plt

from onset_functions import gamma_1, gamma_2, gamma_3

date = pd.date_range(start='1/1/1976', end='31/12/1976')

precip = np.array(
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 25.1, 0.0, 0.0, 42.1, 0.0, 5.5, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 28.1, 0.0, 0.0, 9.4, 0.0, 30.6, 0.0, 0.3, 0.0, 41.4, 19.6, 3.3, 0.0, 11.0, 0.0, 0.0, 1.2,
     0.0, 12.6, 0.0, 19.5, 0.0, 22.5, 0.0, 8.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.2, 0.0, 11.2, 0.0, 2.0, 0.0, 19.9,
     0.0, 0.0, 0.0, 0.0, 0.0, 38.7, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 13.5, 0.0, 0.0, 4.7, 0.0, 0.0, 13.4, 0.0, 0.0,
     0.0, 0.0, 6.5, 8.2, 0.0, 0.8, 0.0, 0.0, 0.0, 9.1, 0.0, 0.0, 0.0, 59.0, 1.7, 0.0, 0.0, 0.0, 0.0, 4.1, 0.0,
     27.7, 0.0, 26.4, 0.0, 3.0, 0.0, 0.0, 0.0, 4.4, 0.0, 20.4, 0.0, 0.0, 0.0, 2.3, 0.0, 9.7, 3.3, 17.5, 0.0, 0.0,
     0.0, 0.0, 10.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.1, 0.0, 0.0, 0.0, 9.6, 0.0, 0.0, 3.4, 0.0, 0.0, 0.0,
     10.2, 0.0, 0.0, 0.0, 0.0, 0.0, 20.5, 2.1, 0.0, 0.0, 0.0, 0.9, 0.0, 0.0, 0.0, 5.2, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 22.7, 0.0, 0.0, 0.0, 0.0, 0.0, 5.5, 48.5, 0.0, 0.0, 0.0, 0.0, 17.5, 0.0, 0.0, 0.0, 7.6, 0.0, 64.0,
     0.0, 0.0, 7.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
     0.0])

x_1 = gamma_1(precip, 25, 15)
x_2 = gamma_2(precip, 5, 1, 1)
x_3 = gamma_3(precip, 10, 6, 1)
x = x_1 * x_2 * x_3
onset = date[np.argmax(x >= 0.2)]

plt.plot(date, precip)
plt.scatter(onset, 1, marker="x", s=300, color="red")
plt.show()
